<html>
<head>
<title>Roomba 500</title>
</head>
<body>
<h1>Roomba 500</h1>
<table width='100%'>
<tr>
<td width="33%"><button style="width:100%;height:100" ontouchstart="irtouch('infinite:roomba:139')" onmousedown="irmouse('infinite:roomba:139')">Arc Left</button></td>
<td width="33%"><button style="width:100%;height:100" ontouchstart="irtouch('infinite:roomba:130')" onmousedown="irmouse('infinite:roomba:130')">Forward</button></td>
<td width="33%"><button style="width:100%;height:100" ontouchstart="irtouch('infinite:roomba:140')" onmousedown="irmouse('infinite:roomba:140')">Arc Right</button></td>
</tr>
<tr>
<td width="33%"><button style="width:100%;height:100" ontouchstart="irtouch('infinite:roomba:129')" onmousedown="irmouse('infinite:roomba:129')">Left</button></td>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=500000:roomba:137')">Stop</button></td>
<td width="33%"><button style="width:100%;height:100" ontouchstart="irtouch('infinite:roomba:131')" onmousedown="irmouse('infinite:roomba:131')">Right</button></td>
</tr>
<tr>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=1000000:roomba:129')">Left 1 sec</button></td>
<td width="33%"></td>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=1000000:roomba:131')">Right 1 sec</button></td>
</tr>
<tr>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=500000:roomba:134')">Small</button></td>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=500000:roomba:135')">Medium</button></td>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=500000:roomba:136')">Large</button></td>
</tr>
<tr>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=500000:roomba:132')">Spot</button></td>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=500000:roomba:133')">Max</button></td>
<td width="33%"><button style="width:100%;height:100" onclick="send('time=1000000:roomba:138')"">Power</button></td>
</tr>
</table>

<script type='text/javascript'>
var touchmode = false;

function irtouch(code)
{
    touchmode = true;

    send(code);
    
    if (code.indexOf('infinite:') == 0) {
       cancel = function() {
           document.ontouchend = null;
           document.ontouchcancel = null;
           send('stop');
       };
       document.ontouchend = cancel;
       document.ontouchcancel = cancel;
    }
}

function irmouse(code)
{
    if(touchmode) {
        return;
    }

    send(code);

    if (code.indexOf('infinite:') == 0) {
       document.onmouseup = function() {
           document.onmouseup = null;
           send('stop');
       };
    }
}

function send(code) {
    var xmlHttp = null;

    xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "HEAD", "/empty.html?ir="+code, true );
    xmlHttp.send( null );
}
</script>

</body>

</html>

